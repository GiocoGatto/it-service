<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Admin Dashboard</title>
    <style>
        body { font-family: sans-serif; padding: 15px; background: #1e293b; color: white; }
        .task-card { background: white; color: #333; padding: 15px; margin-bottom: 10px; border-radius: 8px; }
        .btn-done { background: #22c55e; color: white; border: none; padding: 10px; width: 100%; border-radius: 5px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <h2>üõ† ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà</h2>
    <div id="taskList">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbxu8LPDtJxSnUxYZNigXnGYPnnT60GESDG7cZo-KsJfy5MLAXHMvwMKhMcFqkInashdaQ/exec";

        function loadTasks() {
            fetch(scriptURL + "?action=getPending")
            .then(res => res.json())
            .then(data => {
                let html = '';
                data.forEach(task => {
                    html += `
                        <div class="task-card" style="border-left: 5px solid #2563eb;">
                            <p><strong>üë§ ‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á:</strong> ${task.name}</p>
                            
                            <p><strong>üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</strong> 
                                <a href="tel:${task.phone}" style="color: #2563eb; font-weight: bold; text-decoration: none;">
                                    ${task.phone} (üì± ‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏ó‡∏£)
                                </a>
                            </p>
                            
                            <p><strong>üè¢ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà:</strong> ${task.location}</p>
                            <p><strong>üõ† ‡∏õ‡∏±‡∏ç‡∏´‡∏≤:</strong> ${task.issue}</p>
                            <button class="btn-done" onclick="markDone(${task.row})">‚úÖ ‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</button>
                        </div>
                    `;
                });
                document.getElementById('taskList').innerHTML = html || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏Ñ‡∏£‡∏±‡∏ö üéâ';
            });
        }

        function markDone(row) {
            if(confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß?')) {
                fetch(scriptURL + "?action=updateStatus&row=" + row)
                .then(() => {
                    alert('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡πâ‡∏ß!');
                    loadTasks(); // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
                });
            }
        }

        loadTasks(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
    </script>
</body>
</html>